{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport { List, Text, TextInput } from 'react-native-paper';\nimport View from \"react-native-web/dist/exports/View\";\nimport { useContext, useState } from 'react';\nimport { v4 as uuidv4 } from 'uuid';\nimport { AppContext } from \"../scripts/AppContext\";\nimport { broadcastTextMessage, onTextMessageReceive } from \"../scripts/Socket\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Home() {\n  var appContext = useContext(AppContext);\n  var _useState = useState(\"\"),\n    _useState2 = _slicedToArray(_useState, 2),\n    textMessage = _useState2[0],\n    setTextMessage = _useState2[1];\n  var _useState3 = useState([{\n      id: uuidv4(),\n      message: 'this is a message. its still sending...',\n      user: appContext.clientId,\n      timestamp: new Date().getTime(),\n      timezoneOffset: new Date().getTimezoneOffset(),\n      sent: false\n    }, {\n      id: uuidv4(),\n      message: 'this is another message',\n      user: appContext.clientId,\n      timestamp: new Date().getTime() - 10000,\n      timezoneOffset: new Date().getTimezoneOffset(),\n      sent: true\n    }, {\n      id: uuidv4(),\n      message: 'this is yet another message, but this time its not from me.',\n      user: 'nugget',\n      timestamp: new Date().getTime() - 30000,\n      timezoneOffset: new Date().getTimezoneOffset(),\n      sent: true\n    }]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    messagesList = _useState4[0],\n    setMessagesList = _useState4[1];\n  var theme = appContext.themes.current();\n  var onSubmitTextMessage = function onSubmitTextMessage() {\n    setTextMessage(\"\");\n    broadcastTextMessage({\n      id: uuidv4(),\n      message: textMessage,\n      fullname: appContext.clientName,\n      userId: appContext.clientId,\n      timestamp: new Date().getTime(),\n      timezoneOffset: new Date().getTimezoneOffset()\n    });\n  };\n  onTextMessageReceive(function (m) {\n    var messagesIds = messagesList.map(function (a) {\n      return a.id;\n    });\n    var confirmingMessage = messagesIds.find(m.id);\n    if (m.user === appContext.clientId && confirmingMessage !== undefined) {\n      var newMessagesList = messagesList;\n      newMessagesList[messagesIds.indexOf(m.id)] = _objectSpread(_objectSpread({}, confirmingMessage), {}, {\n        sent: true,\n        own: true\n      });\n      setMessagesList(newMessagesList);\n    } else {\n      var newMsg = _objectSpread(_objectSpread({}, m), {}, {\n        sent: true,\n        own: false\n      });\n      setMessagesList(_objectSpread(_objectSpread({}, messagesList), {}, {\n        newMsg: newMsg\n      }));\n    }\n  });\n  console.log(theme);\n  return _jsxs(View, {\n    children: [_jsx(TextInput, {\n      style: {\n        margin: 10\n      },\n      value: textMessage,\n      label: \"Enter Message to broadcast!\",\n      onChangeText: setTextMessage,\n      onSubmitEditing: onSubmitTextMessage\n    }), messagesList.sort(function (a, b) {\n      return a.timestamp < b.timestamp;\n    }).map(function (message) {\n      return _jsx(List.Item, {\n        title: message.fullname,\n        description: message.message,\n        left: function left() {\n          return _jsx(List.Icon, {\n            style: {\n              borderRadius: 100,\n              opacity: message.sent ? 1 : 0.5,\n              backgroundColor: message.own ? theme.colors.primary : \"\"\n            },\n            icon: \"message\",\n            color: message.own ? theme.colors.inverseSurface : theme.colors.surface\n          });\n        }\n      });\n    })]\n  });\n}","map":{"version":3,"names":["List","Text","TextInput","useContext","useState","v4","uuidv4","AppContext","broadcastTextMessage","onTextMessageReceive","Home","appContext","textMessage","setTextMessage","id","message","user","clientId","timestamp","Date","getTime","timezoneOffset","getTimezoneOffset","sent","messagesList","setMessagesList","theme","themes","current","onSubmitTextMessage","fullname","clientName","userId","m","messagesIds","map","a","confirmingMessage","find","undefined","newMessagesList","indexOf","own","newMsg","console","log","margin","sort","b","borderRadius","opacity","backgroundColor","colors","primary","inverseSurface","surface"],"sources":["E:/_Data/ThomasCattGithub/ChessMultiplayer/frontend/assets/views/Messaging.js"],"sourcesContent":["import { List, Text, TextInput } from 'react-native-paper';\r\nimport { View } from 'react-native';\r\nimport { useContext, useState } from 'react';\r\nimport { v4 as uuidv4 } from 'uuid'\r\nimport { AppContext } from '../scripts/AppContext'\r\nimport { broadcastTextMessage, onTextMessageReceive } from '../scripts/Socket'\r\n\r\nexport default function Home() {\r\n\tconst appContext = useContext(AppContext)\r\n\r\n    const [textMessage, setTextMessage] = useState(\"\")\r\n    const [messagesList, setMessagesList] = useState([\r\n        {\r\n            id: uuidv4(),\r\n            message: 'this is a message. its still sending...',\r\n            user: appContext.clientId,\r\n            timestamp: new Date().getTime(),\r\n            timezoneOffset: new Date().getTimezoneOffset(),\r\n            sent: false\r\n        },\r\n        {\r\n            id: uuidv4(),\r\n            message: 'this is another message',\r\n            user: appContext.clientId,\r\n            timestamp: new Date().getTime() - 10000,\r\n            timezoneOffset: new Date().getTimezoneOffset(),\r\n            sent: true\r\n        },\r\n        {\r\n            id: uuidv4(),\r\n            message: 'this is yet another message, but this time its not from me.',\r\n            user: 'nugget',\r\n            timestamp: new Date().getTime() - 30000,\r\n            timezoneOffset: new Date().getTimezoneOffset(),\r\n            sent: true\r\n        },\r\n    ])\r\n    const theme = appContext.themes.current()\r\n\r\n    const onSubmitTextMessage = () => {\r\n        setTextMessage(\"\")\r\n        broadcastTextMessage({\r\n            id: uuidv4(),\r\n            message: textMessage,\r\n            fullname: appContext.clientName,\r\n            userId: appContext.clientId,\r\n            timestamp: new Date().getTime(),\r\n            timezoneOffset: new Date().getTimezoneOffset()\r\n        })\r\n    }\r\n\r\n    onTextMessageReceive((m) => {\r\n        const messagesIds = messagesList.map(a => a.id)\r\n        const confirmingMessage = messagesIds.find(m.id)\r\n        if ((m.user === appContext.clientId) && (confirmingMessage !== undefined)) {\r\n            let newMessagesList = messagesList\r\n            newMessagesList[messagesIds.indexOf(m.id)] = {...confirmingMessage, sent: true, own: true}\r\n            setMessagesList(newMessagesList)\r\n        } else {\r\n            const newMsg = {...m, sent: true, own: false}\r\n            setMessagesList({...messagesList, newMsg})\r\n        }\r\n    })\r\n\r\n    console.log(theme)\r\n\r\n    return <View>\r\n        <TextInput style={{\r\n            margin: 10,\r\n        }} value={textMessage} label={\"Enter Message to broadcast!\"} onChangeText={setTextMessage} onSubmitEditing={onSubmitTextMessage}/>\r\n        \r\n        {\r\n            messagesList.sort( (a, b) => a.timestamp < b.timestamp).map(message => { return (\r\n                <List.Item\r\n                    title={message.fullname}\r\n                    description={message.message}\r\n                    left={() => <List.Icon\r\n                        style={{borderRadius: 100, opacity: message.sent ? 1 : 0.5, backgroundColor: message.own ? theme.colors.primary : \"\"}}\r\n                        icon={\"message\"}\r\n                        color={message.own ? theme.colors.inverseSurface : theme.colors.surface} />}\r\n                />\r\n            )})\r\n        }\r\n        \r\n    </View>\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}